{% extends "base.html" %}
{% load static i18n %}
{% block title %}Wasla | Auth{% endblock %}
{% block global_lang_switcher %}{% endblock %}
{% block body %}
<div class="auth-shell">
  <div class="card auth-card stack-24">
    <div class="auth-header">
      <form action="{% url 'set_language' %}" method="post">
          {% csrf_token %}
          <input name="next" type="hidden" value="{{ request.get_full_path }}">
          {% get_current_language as LANGUAGE_CODE %}
          {% if LANGUAGE_CODE == 'ar' %}
            <input type="hidden" name="language" value="en">
            <button class="btn btn-soft" type="submit">English</button>
          {% else %}
            <input type="hidden" name="language" value="ar">
            <button class="btn btn-soft" type="submit">العربية</button>
          {% endif %}
      </form>
      <img class="auth-logo" src="{% static 'images/logo.jpeg' %}" alt="Wasla">
    </div>

    <div class="auth-tabs">
      <a class="auth-tab {% if active_tab == 'login' %}active{% endif %}" href="?tab=login">{% trans "Sign in" %}</a>
      <a class="auth-tab {% if active_tab != 'login' %}active{% endif %}" href="?tab=register">{% trans "Create account" %}</a>
    </div>

    <div>
      {% if active_tab == "login" %}
        <form method="post" class="stack-16">
          {% csrf_token %}
          <input type="hidden" name="action" value="login">
          <div class="auth-field">
            <label class="auth-label">{% trans "Email" %}</label>
            {{ login_form.email }}
            {% for e in login_form.email.errors %}<div class="error">{{e}}</div>{% endfor %}
          </div>
          <div class="auth-field">
            <label class="auth-label">{% trans "Password" %}</label>
            {{ login_form.password }}
            {% for e in login_form.password.errors %}<div class="error">{{e}}</div>{% endfor %}
          </div>
          <button class="btn btn-primary btn-block" type="submit">{% trans "Continue" %}</button>
        </form>
      {% else %}
        <form method="post" class="stack-16">
          {% csrf_token %}
          <input type="hidden" name="action" value="register">
          <div class="auth-field">
            <label class="auth-label">{% trans "Full name" %}</label>
            {{ register_form.full_name }}
            {% for e in register_form.full_name.errors %}<div class="error">{{e}}</div>{% endfor %}
          </div>
          <div class="auth-field">
            <label class="auth-label">{% trans "Email" %}</label>
            {{ register_form.email }}
            {% for e in register_form.email.errors %}<div class="error">{{e}}</div>{% endfor %}
          </div>
          <div class="auth-field">
            <label class="auth-label">{% trans "Mobile number" %}</label>
            <div class="auth-phone">
              {{ register_form.phone_country }}
              {{ register_form.phone_number }}
            </div>
            {% for e in register_form.phone_number.errors %}<div class="error">{{e}}</div>{% endfor %}
          </div>
          <div class="auth-field">
            <label class="auth-label">{% trans "Password" %}</label>
            {{ register_form.password }}
            {% for e in register_form.password.errors %}<div class="error">{{e}}</div>{% endfor %}
          </div>

          <button class="btn btn-primary btn-block" type="submit">{% trans "Continue" %}</button>
          <div class="muted">{% trans "By signing up you agree to Wasla Terms of Service and Privacy Policy." %}</div>
        </form>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
