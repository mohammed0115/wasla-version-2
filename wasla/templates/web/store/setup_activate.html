{% extends "base.html" %}
{% block title %}إعداد المتجر | الإطلاق{% endblock %}
{% block body %}
<div class="container">
  {% include "web/store/_wizard_header.html" with wizard_title="الخطوة 4 — الإطلاق" %}

  <div class="card" style="padding:18px;">
    <div style="display:flex; align-items:flex-start; justify-content:space-between; gap:12px; flex-wrap:wrap;">
      <div>
        <h2 style="margin:0;">جاهزية المتجر للإطلاق</h2>
        <div class="muted" style="margin-top:6px;">الرابط العام: <b>{{ public_url_hint }}</b></div>
      </div>
      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <a class="btn btn-soft" href="{% url 'tenants:store_setup_step3' %}">رجوع</a>
      </div>
    </div>

    <div style="margin-top:14px; display:grid; gap:10px;">
      {% if readiness and readiness.ok %}
        <div class="alert success">✅ المتجر جاهز للإطلاق.</div>
      {% else %}
        <div class="alert warn">⚠️ المتجر غير جاهز بعد. أكمل العناصر الناقصة أدناه.</div>
      {% endif %}

      {% if readiness and readiness.errors %}
        <ul class="muted" style="margin:0; padding-right:18px;">
          {% for e in readiness.errors %}
            <li>{{ e }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>

    <form method="post" style="margin-top:16px; display:flex; gap:10px; flex-wrap:wrap;">
      {% csrf_token %}
      <input type="hidden" name="action" value="activate">
      <button class="btn" type="submit" {% if readiness and not readiness.ok %}disabled{% endif %}>إطلاق المتجر</button>
      {% if tenant.is_published %}
        <button class="btn btn-soft" formmethod="post" name="action" value="deactivate">إيقاف مؤقت</button>
      {% endif %}
      <a class="btn btn-soft" href="/dashboard">لوحة التحكم</a>
    </form>

    <div style="margin-top:18px;" class="muted">
      عند الإطلاق سيتم وضع المتجر على الوضع العام (Published) واعتبار الإعداد مكتمل.
    </div>
  </div>
</div>
{% endblock %}
